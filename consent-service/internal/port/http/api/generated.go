// Package api provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package api

import (
	"bytes"
	"compress/gzip"
	"context"
	"encoding/base64"
	"encoding/json"
	"fmt"
	"net/http"
	"net/url"
	"path"
	"strings"
	"time"

	"github.com/getkin/kin-openapi/openapi3"
	"github.com/gin-gonic/gin"
	"github.com/oapi-codegen/runtime"
	strictgin "github.com/oapi-codegen/runtime/strictmiddleware/gin"
)

// Defines values for ConsentAcceptanceMethod.
const (
	Direct ConsentAcceptanceMethod = "direct"
	Link   ConsentAcceptanceMethod = "link"
)

// AcceptConsentRequest defines model for AcceptConsentRequest.
type AcceptConsentRequest struct {
	AcceptedPolicies []string `json:"accepted_policies"`
}

// AddVersionRequest defines model for AddVersionRequest.
type AddVersionRequest struct {
	ContentHtml     *string `json:"content_html,omitempty"`
	ContentMarkdown *string `json:"content_markdown,omitempty"`
	IsActive        *bool   `json:"is_active,omitempty"`
	PdfUrl          *string `json:"pdf_url,omitempty"`
	Version         string  `json:"version"`
}

// Consent defines model for Consent.
type Consent struct {
	AcceptanceMethod *ConsentAcceptanceMethod `json:"acceptance_method,omitempty"`
	AcceptedAt       *time.Time               `json:"accepted_at,omitempty"`
	Id               *string                  `json:"id,omitempty"`
	LinkToken        *string                  `json:"link_token"`
	PolicySlug       *string                  `json:"policy_slug,omitempty"`
	PolicyVersion    *string                  `json:"policy_version,omitempty"`
	RevokedAt        *time.Time               `json:"revoked_at"`
	RevokedBy        *string                  `json:"revoked_by"`
	Subject          *string                  `json:"subject,omitempty"`
}

// ConsentAcceptanceMethod defines model for Consent.AcceptanceMethod.
type ConsentAcceptanceMethod string

// ConsentLink defines model for ConsentLink.
type ConsentLink struct {
	CreatedAt *time.Time `json:"created_at,omitempty"`
	CreatedBy *string    `json:"created_by,omitempty"`
	ExpiresAt *time.Time `json:"expires_at,omitempty"`
	Policies  *[]string  `json:"policies,omitempty"`
	Subject   *string    `json:"subject,omitempty"`
	Token     *string    `json:"token,omitempty"`
	UsedAt    *time.Time `json:"used_at"`
}

// ConsentsResponse defines model for ConsentsResponse.
type ConsentsResponse struct {
	Consents *[]Consent `json:"consents,omitempty"`
}

// CreateConsentRequest defines model for CreateConsentRequest.
type CreateConsentRequest struct {
	Policies []struct {
		Slug string `json:"slug"`

		// Version If not provided, uses the active version
		Version *string `json:"version,omitempty"`
	} `json:"policies"`
	Subject string `json:"subject"`
}

// CreateLinkRequest defines model for CreateLinkRequest.
type CreateLinkRequest struct {
	CreatedBy      string   `json:"created_by"`
	ExpiresInHours int      `json:"expires_in_hours"`
	Policies       []string `json:"policies"`
	Subject        string   `json:"subject"`
}

// CreateLinkResponse defines model for CreateLinkResponse.
type CreateLinkResponse struct {
	ExpiresAt *time.Time `json:"expires_at,omitempty"`
	Token     *string    `json:"token,omitempty"`
	Url       *string    `json:"url,omitempty"`
}

// CreatePolicyRequest defines model for CreatePolicyRequest.
type CreatePolicyRequest struct {
	Description *string `json:"description,omitempty"`
	Name        string  `json:"name"`
	Slug        string  `json:"slug"`
}

// ErrorResponse defines model for ErrorResponse.
type ErrorResponse struct {
	Error *string `json:"error,omitempty"`
}

// Policy defines model for Policy.
type Policy struct {
	CreatedAt   *time.Time       `json:"created_at,omitempty"`
	Description *string          `json:"description,omitempty"`
	Name        *string          `json:"name,omitempty"`
	Slug        *string          `json:"slug,omitempty"`
	UpdatedAt   *time.Time       `json:"updated_at,omitempty"`
	Versions    *[]PolicyVersion `json:"versions,omitempty"`
}

// PolicyListResponse defines model for PolicyListResponse.
type PolicyListResponse struct {
	Policies *[]Policy `json:"policies,omitempty"`
}

// PolicyVersion defines model for PolicyVersion.
type PolicyVersion struct {
	ContentHtml     *string    `json:"content_html,omitempty"`
	ContentMarkdown *string    `json:"content_markdown,omitempty"`
	IsActive        *bool      `json:"is_active,omitempty"`
	PdfUrl          *string    `json:"pdf_url,omitempty"`
	PublishedAt     *time.Time `json:"published_at,omitempty"`
	Version         *string    `json:"version,omitempty"`
}

// PublicLinkInfo defines model for PublicLinkInfo.
type PublicLinkInfo struct {
	ExpiresAt *time.Time          `json:"expires_at,omitempty"`
	Policies  *[]PublicPolicyInfo `json:"policies,omitempty"`
	Subject   *string             `json:"subject,omitempty"`
	Token     *string             `json:"token,omitempty"`
}

// PublicPolicyInfo defines model for PublicPolicyInfo.
type PublicPolicyInfo struct {
	ContentHtml     *string `json:"content_html,omitempty"`
	ContentMarkdown *string `json:"content_markdown,omitempty"`
	Description     *string `json:"description,omitempty"`
	Name            *string `json:"name,omitempty"`
	PdfUrl          *string `json:"pdf_url,omitempty"`
	Slug            *string `json:"slug,omitempty"`
	Version         *string `json:"version,omitempty"`
}

// RevokeConsentRequest defines model for RevokeConsentRequest.
type RevokeConsentRequest struct {
	RevokedBy string `json:"revoked_by"`
}

// SubjectConsentsResponse defines model for SubjectConsentsResponse.
type SubjectConsentsResponse struct {
	Consents *[]Consent `json:"consents,omitempty"`
	Subject  *string    `json:"subject,omitempty"`
}

// BadRequest defines model for BadRequest.
type BadRequest = ErrorResponse

// InternalServerError defines model for InternalServerError.
type InternalServerError = ErrorResponse

// NotFound defines model for NotFound.
type NotFound = ErrorResponse

// GetConsentsParams defines parameters for GetConsents.
type GetConsentsParams struct {
	// Subject Subject identifier (external ID)
	Subject string `form:"subject" json:"subject"`

	// Policy Filter by specific policy slug
	Policy *string `form:"policy,omitempty" json:"policy,omitempty"`
}

// ListPoliciesParams defines parameters for ListPolicies.
type ListPoliciesParams struct {
	// Active Filter to only policies with active versions
	Active *bool `form:"active,omitempty" json:"active,omitempty"`
}

// CreateConsentJSONRequestBody defines body for CreateConsent for application/json ContentType.
type CreateConsentJSONRequestBody = CreateConsentRequest

// RevokeConsentJSONRequestBody defines body for RevokeConsent for application/json ContentType.
type RevokeConsentJSONRequestBody = RevokeConsentRequest

// CreateLinkJSONRequestBody defines body for CreateLink for application/json ContentType.
type CreateLinkJSONRequestBody = CreateLinkRequest

// CreatePolicyJSONRequestBody defines body for CreatePolicy for application/json ContentType.
type CreatePolicyJSONRequestBody = CreatePolicyRequest

// AddPolicyVersionJSONRequestBody defines body for AddPolicyVersion for application/json ContentType.
type AddPolicyVersionJSONRequestBody = AddVersionRequest

// AcceptConsentJSONRequestBody defines body for AcceptConsent for application/json ContentType.
type AcceptConsentJSONRequestBody = AcceptConsentRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// Get consents for a subject
	// (GET /admin/consents)
	GetConsents(c *gin.Context, params GetConsentsParams)
	// Create consents (direct acceptance via tablet/operator)
	// (POST /admin/consents)
	CreateConsent(c *gin.Context)
	// Revoke a consent
	// (DELETE /admin/consents/{id})
	RevokeConsent(c *gin.Context, id string)
	// Get consent by ID
	// (GET /admin/consents/{id})
	GetConsentById(c *gin.Context, id string)
	// Create a shareable consent link
	// (POST /admin/links)
	CreateLink(c *gin.Context)
	// Invalidate a consent link
	// (DELETE /admin/links/{token})
	DeleteLink(c *gin.Context, token string)
	// Get link status
	// (GET /admin/links/{token})
	GetLinkStatus(c *gin.Context, token string)
	// List all policies
	// (GET /admin/policies)
	ListPolicies(c *gin.Context, params ListPoliciesParams)
	// Create a new policy
	// (POST /admin/policies)
	CreatePolicy(c *gin.Context)
	// Get policy details
	// (GET /admin/policies/{slug})
	GetPolicy(c *gin.Context, slug string)
	// Add a new version to a policy
	// (POST /admin/policies/{slug}/versions)
	AddPolicyVersion(c *gin.Context, slug string)
	// Get link info for consent acceptance
	// (GET /public/links/{token})
	GetPublicLinkInfo(c *gin.Context, token string)
	// Accept consents via link
	// (POST /public/links/{token}/accept)
	AcceptConsent(c *gin.Context, token string)
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler            ServerInterface
	HandlerMiddlewares []MiddlewareFunc
	ErrorHandler       func(*gin.Context, error, int)
}

type MiddlewareFunc func(c *gin.Context)

// GetConsents operation middleware
func (siw *ServerInterfaceWrapper) GetConsents(c *gin.Context) {

	var err error

	// Parameter object where we will unmarshal all parameters from the context
	var params GetConsentsParams

	// ------------- Required query parameter "subject" -------------

	if paramValue := c.Query("subject"); paramValue != "" {

	} else {
		siw.ErrorHandler(c, fmt.Errorf("Query argument subject is required, but not found"), http.StatusBadRequest)
		return
	}

	err = runtime.BindQueryParameter("form", true, true, "subject", c.Request.URL.Query(), &params.Subject)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter subject: %w", err), http.StatusBadRequest)
		return
	}

	// ------------- Optional query parameter "policy" -------------

	err = runtime.BindQueryParameter("form", true, false, "policy", c.Request.URL.Query(), &params.Policy)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter policy: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetConsents(c, params)
}

// CreateConsent operation middleware
func (siw *ServerInterfaceWrapper) CreateConsent(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.CreateConsent(c)
}

// RevokeConsent operation middleware
func (siw *ServerInterfaceWrapper) RevokeConsent(c *gin.Context) {

	var err error

	// ------------- Path parameter "id" -------------
	var id string

	err = runtime.BindStyledParameterWithOptions("simple", "id", c.Param("id"), &id, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter id: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.RevokeConsent(c, id)
}

// GetConsentById operation middleware
func (siw *ServerInterfaceWrapper) GetConsentById(c *gin.Context) {

	var err error

	// ------------- Path parameter "id" -------------
	var id string

	err = runtime.BindStyledParameterWithOptions("simple", "id", c.Param("id"), &id, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter id: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetConsentById(c, id)
}

// CreateLink operation middleware
func (siw *ServerInterfaceWrapper) CreateLink(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.CreateLink(c)
}

// DeleteLink operation middleware
func (siw *ServerInterfaceWrapper) DeleteLink(c *gin.Context) {

	var err error

	// ------------- Path parameter "token" -------------
	var token string

	err = runtime.BindStyledParameterWithOptions("simple", "token", c.Param("token"), &token, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter token: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.DeleteLink(c, token)
}

// GetLinkStatus operation middleware
func (siw *ServerInterfaceWrapper) GetLinkStatus(c *gin.Context) {

	var err error

	// ------------- Path parameter "token" -------------
	var token string

	err = runtime.BindStyledParameterWithOptions("simple", "token", c.Param("token"), &token, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter token: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetLinkStatus(c, token)
}

// ListPolicies operation middleware
func (siw *ServerInterfaceWrapper) ListPolicies(c *gin.Context) {

	var err error

	// Parameter object where we will unmarshal all parameters from the context
	var params ListPoliciesParams

	// ------------- Optional query parameter "active" -------------

	err = runtime.BindQueryParameter("form", true, false, "active", c.Request.URL.Query(), &params.Active)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter active: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.ListPolicies(c, params)
}

// CreatePolicy operation middleware
func (siw *ServerInterfaceWrapper) CreatePolicy(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.CreatePolicy(c)
}

// GetPolicy operation middleware
func (siw *ServerInterfaceWrapper) GetPolicy(c *gin.Context) {

	var err error

	// ------------- Path parameter "slug" -------------
	var slug string

	err = runtime.BindStyledParameterWithOptions("simple", "slug", c.Param("slug"), &slug, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter slug: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetPolicy(c, slug)
}

// AddPolicyVersion operation middleware
func (siw *ServerInterfaceWrapper) AddPolicyVersion(c *gin.Context) {

	var err error

	// ------------- Path parameter "slug" -------------
	var slug string

	err = runtime.BindStyledParameterWithOptions("simple", "slug", c.Param("slug"), &slug, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter slug: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.AddPolicyVersion(c, slug)
}

// GetPublicLinkInfo operation middleware
func (siw *ServerInterfaceWrapper) GetPublicLinkInfo(c *gin.Context) {

	var err error

	// ------------- Path parameter "token" -------------
	var token string

	err = runtime.BindStyledParameterWithOptions("simple", "token", c.Param("token"), &token, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter token: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetPublicLinkInfo(c, token)
}

// AcceptConsent operation middleware
func (siw *ServerInterfaceWrapper) AcceptConsent(c *gin.Context) {

	var err error

	// ------------- Path parameter "token" -------------
	var token string

	err = runtime.BindStyledParameterWithOptions("simple", "token", c.Param("token"), &token, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter token: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.AcceptConsent(c, token)
}

// GinServerOptions provides options for the Gin server.
type GinServerOptions struct {
	BaseURL      string
	Middlewares  []MiddlewareFunc
	ErrorHandler func(*gin.Context, error, int)
}

// RegisterHandlers creates http.Handler with routing matching OpenAPI spec.
func RegisterHandlers(router gin.IRouter, si ServerInterface) {
	RegisterHandlersWithOptions(router, si, GinServerOptions{})
}

// RegisterHandlersWithOptions creates http.Handler with additional options
func RegisterHandlersWithOptions(router gin.IRouter, si ServerInterface, options GinServerOptions) {
	errorHandler := options.ErrorHandler
	if errorHandler == nil {
		errorHandler = func(c *gin.Context, err error, statusCode int) {
			c.JSON(statusCode, gin.H{"msg": err.Error()})
		}
	}

	wrapper := ServerInterfaceWrapper{
		Handler:            si,
		HandlerMiddlewares: options.Middlewares,
		ErrorHandler:       errorHandler,
	}

	router.GET(options.BaseURL+"/admin/consents", wrapper.GetConsents)
	router.POST(options.BaseURL+"/admin/consents", wrapper.CreateConsent)
	router.DELETE(options.BaseURL+"/admin/consents/:id", wrapper.RevokeConsent)
	router.GET(options.BaseURL+"/admin/consents/:id", wrapper.GetConsentById)
	router.POST(options.BaseURL+"/admin/links", wrapper.CreateLink)
	router.DELETE(options.BaseURL+"/admin/links/:token", wrapper.DeleteLink)
	router.GET(options.BaseURL+"/admin/links/:token", wrapper.GetLinkStatus)
	router.GET(options.BaseURL+"/admin/policies", wrapper.ListPolicies)
	router.POST(options.BaseURL+"/admin/policies", wrapper.CreatePolicy)
	router.GET(options.BaseURL+"/admin/policies/:slug", wrapper.GetPolicy)
	router.POST(options.BaseURL+"/admin/policies/:slug/versions", wrapper.AddPolicyVersion)
	router.GET(options.BaseURL+"/public/links/:token", wrapper.GetPublicLinkInfo)
	router.POST(options.BaseURL+"/public/links/:token/accept", wrapper.AcceptConsent)
}

type BadRequestJSONResponse ErrorResponse

type InternalServerErrorJSONResponse ErrorResponse

type NotFoundJSONResponse ErrorResponse

type GetConsentsRequestObject struct {
	Params GetConsentsParams
}

type GetConsentsResponseObject interface {
	VisitGetConsentsResponse(w http.ResponseWriter) error
}

type GetConsents200JSONResponse SubjectConsentsResponse

func (response GetConsents200JSONResponse) VisitGetConsentsResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type GetConsents400JSONResponse struct{ BadRequestJSONResponse }

func (response GetConsents400JSONResponse) VisitGetConsentsResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type GetConsents404JSONResponse struct{ NotFoundJSONResponse }

func (response GetConsents404JSONResponse) VisitGetConsentsResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type GetConsents500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response GetConsents500JSONResponse) VisitGetConsentsResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type CreateConsentRequestObject struct {
	Body *CreateConsentJSONRequestBody
}

type CreateConsentResponseObject interface {
	VisitCreateConsentResponse(w http.ResponseWriter) error
}

type CreateConsent201JSONResponse ConsentsResponse

func (response CreateConsent201JSONResponse) VisitCreateConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(201)

	return json.NewEncoder(w).Encode(response)
}

type CreateConsent400JSONResponse struct{ BadRequestJSONResponse }

func (response CreateConsent400JSONResponse) VisitCreateConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type CreateConsent404JSONResponse struct{ NotFoundJSONResponse }

func (response CreateConsent404JSONResponse) VisitCreateConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type CreateConsent500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response CreateConsent500JSONResponse) VisitCreateConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type RevokeConsentRequestObject struct {
	Id   string `json:"id"`
	Body *RevokeConsentJSONRequestBody
}

type RevokeConsentResponseObject interface {
	VisitRevokeConsentResponse(w http.ResponseWriter) error
}

type RevokeConsent200JSONResponse Consent

func (response RevokeConsent200JSONResponse) VisitRevokeConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type RevokeConsent404JSONResponse struct{ NotFoundJSONResponse }

func (response RevokeConsent404JSONResponse) VisitRevokeConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type RevokeConsent409JSONResponse ErrorResponse

func (response RevokeConsent409JSONResponse) VisitRevokeConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(409)

	return json.NewEncoder(w).Encode(response)
}

type RevokeConsent500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response RevokeConsent500JSONResponse) VisitRevokeConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type GetConsentByIdRequestObject struct {
	Id string `json:"id"`
}

type GetConsentByIdResponseObject interface {
	VisitGetConsentByIdResponse(w http.ResponseWriter) error
}

type GetConsentById200JSONResponse Consent

func (response GetConsentById200JSONResponse) VisitGetConsentByIdResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type GetConsentById404JSONResponse struct{ NotFoundJSONResponse }

func (response GetConsentById404JSONResponse) VisitGetConsentByIdResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type GetConsentById500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response GetConsentById500JSONResponse) VisitGetConsentByIdResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type CreateLinkRequestObject struct {
	Body *CreateLinkJSONRequestBody
}

type CreateLinkResponseObject interface {
	VisitCreateLinkResponse(w http.ResponseWriter) error
}

type CreateLink201JSONResponse CreateLinkResponse

func (response CreateLink201JSONResponse) VisitCreateLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(201)

	return json.NewEncoder(w).Encode(response)
}

type CreateLink400JSONResponse struct{ BadRequestJSONResponse }

func (response CreateLink400JSONResponse) VisitCreateLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type CreateLink404JSONResponse struct{ NotFoundJSONResponse }

func (response CreateLink404JSONResponse) VisitCreateLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type CreateLink500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response CreateLink500JSONResponse) VisitCreateLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type DeleteLinkRequestObject struct {
	Token string `json:"token"`
}

type DeleteLinkResponseObject interface {
	VisitDeleteLinkResponse(w http.ResponseWriter) error
}

type DeleteLink204Response struct {
}

func (response DeleteLink204Response) VisitDeleteLinkResponse(w http.ResponseWriter) error {
	w.WriteHeader(204)
	return nil
}

type DeleteLink404JSONResponse struct{ NotFoundJSONResponse }

func (response DeleteLink404JSONResponse) VisitDeleteLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type DeleteLink500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response DeleteLink500JSONResponse) VisitDeleteLinkResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type GetLinkStatusRequestObject struct {
	Token string `json:"token"`
}

type GetLinkStatusResponseObject interface {
	VisitGetLinkStatusResponse(w http.ResponseWriter) error
}

type GetLinkStatus200JSONResponse ConsentLink

func (response GetLinkStatus200JSONResponse) VisitGetLinkStatusResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type GetLinkStatus404JSONResponse struct{ NotFoundJSONResponse }

func (response GetLinkStatus404JSONResponse) VisitGetLinkStatusResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type GetLinkStatus500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response GetLinkStatus500JSONResponse) VisitGetLinkStatusResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type ListPoliciesRequestObject struct {
	Params ListPoliciesParams
}

type ListPoliciesResponseObject interface {
	VisitListPoliciesResponse(w http.ResponseWriter) error
}

type ListPolicies200JSONResponse PolicyListResponse

func (response ListPolicies200JSONResponse) VisitListPoliciesResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type ListPolicies500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response ListPolicies500JSONResponse) VisitListPoliciesResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type CreatePolicyRequestObject struct {
	Body *CreatePolicyJSONRequestBody
}

type CreatePolicyResponseObject interface {
	VisitCreatePolicyResponse(w http.ResponseWriter) error
}

type CreatePolicy201JSONResponse Policy

func (response CreatePolicy201JSONResponse) VisitCreatePolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(201)

	return json.NewEncoder(w).Encode(response)
}

type CreatePolicy400JSONResponse struct{ BadRequestJSONResponse }

func (response CreatePolicy400JSONResponse) VisitCreatePolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type CreatePolicy409JSONResponse ErrorResponse

func (response CreatePolicy409JSONResponse) VisitCreatePolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(409)

	return json.NewEncoder(w).Encode(response)
}

type CreatePolicy500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response CreatePolicy500JSONResponse) VisitCreatePolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type GetPolicyRequestObject struct {
	Slug string `json:"slug"`
}

type GetPolicyResponseObject interface {
	VisitGetPolicyResponse(w http.ResponseWriter) error
}

type GetPolicy200JSONResponse Policy

func (response GetPolicy200JSONResponse) VisitGetPolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type GetPolicy404JSONResponse struct{ NotFoundJSONResponse }

func (response GetPolicy404JSONResponse) VisitGetPolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type GetPolicy500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response GetPolicy500JSONResponse) VisitGetPolicyResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type AddPolicyVersionRequestObject struct {
	Slug string `json:"slug"`
	Body *AddPolicyVersionJSONRequestBody
}

type AddPolicyVersionResponseObject interface {
	VisitAddPolicyVersionResponse(w http.ResponseWriter) error
}

type AddPolicyVersion201JSONResponse Policy

func (response AddPolicyVersion201JSONResponse) VisitAddPolicyVersionResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(201)

	return json.NewEncoder(w).Encode(response)
}

type AddPolicyVersion400JSONResponse struct{ BadRequestJSONResponse }

func (response AddPolicyVersion400JSONResponse) VisitAddPolicyVersionResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type AddPolicyVersion404JSONResponse struct{ NotFoundJSONResponse }

func (response AddPolicyVersion404JSONResponse) VisitAddPolicyVersionResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type AddPolicyVersion409JSONResponse ErrorResponse

func (response AddPolicyVersion409JSONResponse) VisitAddPolicyVersionResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(409)

	return json.NewEncoder(w).Encode(response)
}

type AddPolicyVersion500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response AddPolicyVersion500JSONResponse) VisitAddPolicyVersionResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type GetPublicLinkInfoRequestObject struct {
	Token string `json:"token"`
}

type GetPublicLinkInfoResponseObject interface {
	VisitGetPublicLinkInfoResponse(w http.ResponseWriter) error
}

type GetPublicLinkInfo200JSONResponse PublicLinkInfo

func (response GetPublicLinkInfo200JSONResponse) VisitGetPublicLinkInfoResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(200)

	return json.NewEncoder(w).Encode(response)
}

type GetPublicLinkInfo404JSONResponse struct{ NotFoundJSONResponse }

func (response GetPublicLinkInfo404JSONResponse) VisitGetPublicLinkInfoResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type GetPublicLinkInfo410JSONResponse ErrorResponse

func (response GetPublicLinkInfo410JSONResponse) VisitGetPublicLinkInfoResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(410)

	return json.NewEncoder(w).Encode(response)
}

type GetPublicLinkInfo500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response GetPublicLinkInfo500JSONResponse) VisitGetPublicLinkInfoResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

type AcceptConsentRequestObject struct {
	Token string `json:"token"`
	Body  *AcceptConsentJSONRequestBody
}

type AcceptConsentResponseObject interface {
	VisitAcceptConsentResponse(w http.ResponseWriter) error
}

type AcceptConsent201JSONResponse ConsentsResponse

func (response AcceptConsent201JSONResponse) VisitAcceptConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(201)

	return json.NewEncoder(w).Encode(response)
}

type AcceptConsent400JSONResponse struct{ BadRequestJSONResponse }

func (response AcceptConsent400JSONResponse) VisitAcceptConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(400)

	return json.NewEncoder(w).Encode(response)
}

type AcceptConsent404JSONResponse struct{ NotFoundJSONResponse }

func (response AcceptConsent404JSONResponse) VisitAcceptConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(404)

	return json.NewEncoder(w).Encode(response)
}

type AcceptConsent410JSONResponse ErrorResponse

func (response AcceptConsent410JSONResponse) VisitAcceptConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(410)

	return json.NewEncoder(w).Encode(response)
}

type AcceptConsent500JSONResponse struct {
	InternalServerErrorJSONResponse
}

func (response AcceptConsent500JSONResponse) VisitAcceptConsentResponse(w http.ResponseWriter) error {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(500)

	return json.NewEncoder(w).Encode(response)
}

// StrictServerInterface represents all server handlers.
type StrictServerInterface interface {
	// Get consents for a subject
	// (GET /admin/consents)
	GetConsents(ctx context.Context, request GetConsentsRequestObject) (GetConsentsResponseObject, error)
	// Create consents (direct acceptance via tablet/operator)
	// (POST /admin/consents)
	CreateConsent(ctx context.Context, request CreateConsentRequestObject) (CreateConsentResponseObject, error)
	// Revoke a consent
	// (DELETE /admin/consents/{id})
	RevokeConsent(ctx context.Context, request RevokeConsentRequestObject) (RevokeConsentResponseObject, error)
	// Get consent by ID
	// (GET /admin/consents/{id})
	GetConsentById(ctx context.Context, request GetConsentByIdRequestObject) (GetConsentByIdResponseObject, error)
	// Create a shareable consent link
	// (POST /admin/links)
	CreateLink(ctx context.Context, request CreateLinkRequestObject) (CreateLinkResponseObject, error)
	// Invalidate a consent link
	// (DELETE /admin/links/{token})
	DeleteLink(ctx context.Context, request DeleteLinkRequestObject) (DeleteLinkResponseObject, error)
	// Get link status
	// (GET /admin/links/{token})
	GetLinkStatus(ctx context.Context, request GetLinkStatusRequestObject) (GetLinkStatusResponseObject, error)
	// List all policies
	// (GET /admin/policies)
	ListPolicies(ctx context.Context, request ListPoliciesRequestObject) (ListPoliciesResponseObject, error)
	// Create a new policy
	// (POST /admin/policies)
	CreatePolicy(ctx context.Context, request CreatePolicyRequestObject) (CreatePolicyResponseObject, error)
	// Get policy details
	// (GET /admin/policies/{slug})
	GetPolicy(ctx context.Context, request GetPolicyRequestObject) (GetPolicyResponseObject, error)
	// Add a new version to a policy
	// (POST /admin/policies/{slug}/versions)
	AddPolicyVersion(ctx context.Context, request AddPolicyVersionRequestObject) (AddPolicyVersionResponseObject, error)
	// Get link info for consent acceptance
	// (GET /public/links/{token})
	GetPublicLinkInfo(ctx context.Context, request GetPublicLinkInfoRequestObject) (GetPublicLinkInfoResponseObject, error)
	// Accept consents via link
	// (POST /public/links/{token}/accept)
	AcceptConsent(ctx context.Context, request AcceptConsentRequestObject) (AcceptConsentResponseObject, error)
}

type StrictHandlerFunc = strictgin.StrictGinHandlerFunc
type StrictMiddlewareFunc = strictgin.StrictGinMiddlewareFunc

func NewStrictHandler(ssi StrictServerInterface, middlewares []StrictMiddlewareFunc) ServerInterface {
	return &strictHandler{ssi: ssi, middlewares: middlewares}
}

type strictHandler struct {
	ssi         StrictServerInterface
	middlewares []StrictMiddlewareFunc
}

// GetConsents operation middleware
func (sh *strictHandler) GetConsents(ctx *gin.Context, params GetConsentsParams) {
	var request GetConsentsRequestObject

	request.Params = params

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.GetConsents(ctx, request.(GetConsentsRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "GetConsents")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(GetConsentsResponseObject); ok {
		if err := validResponse.VisitGetConsentsResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// CreateConsent operation middleware
func (sh *strictHandler) CreateConsent(ctx *gin.Context) {
	var request CreateConsentRequestObject

	var body CreateConsentJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.CreateConsent(ctx, request.(CreateConsentRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "CreateConsent")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(CreateConsentResponseObject); ok {
		if err := validResponse.VisitCreateConsentResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// RevokeConsent operation middleware
func (sh *strictHandler) RevokeConsent(ctx *gin.Context, id string) {
	var request RevokeConsentRequestObject

	request.Id = id

	var body RevokeConsentJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.RevokeConsent(ctx, request.(RevokeConsentRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "RevokeConsent")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(RevokeConsentResponseObject); ok {
		if err := validResponse.VisitRevokeConsentResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// GetConsentById operation middleware
func (sh *strictHandler) GetConsentById(ctx *gin.Context, id string) {
	var request GetConsentByIdRequestObject

	request.Id = id

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.GetConsentById(ctx, request.(GetConsentByIdRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "GetConsentById")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(GetConsentByIdResponseObject); ok {
		if err := validResponse.VisitGetConsentByIdResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// CreateLink operation middleware
func (sh *strictHandler) CreateLink(ctx *gin.Context) {
	var request CreateLinkRequestObject

	var body CreateLinkJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.CreateLink(ctx, request.(CreateLinkRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "CreateLink")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(CreateLinkResponseObject); ok {
		if err := validResponse.VisitCreateLinkResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// DeleteLink operation middleware
func (sh *strictHandler) DeleteLink(ctx *gin.Context, token string) {
	var request DeleteLinkRequestObject

	request.Token = token

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.DeleteLink(ctx, request.(DeleteLinkRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "DeleteLink")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(DeleteLinkResponseObject); ok {
		if err := validResponse.VisitDeleteLinkResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// GetLinkStatus operation middleware
func (sh *strictHandler) GetLinkStatus(ctx *gin.Context, token string) {
	var request GetLinkStatusRequestObject

	request.Token = token

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.GetLinkStatus(ctx, request.(GetLinkStatusRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "GetLinkStatus")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(GetLinkStatusResponseObject); ok {
		if err := validResponse.VisitGetLinkStatusResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// ListPolicies operation middleware
func (sh *strictHandler) ListPolicies(ctx *gin.Context, params ListPoliciesParams) {
	var request ListPoliciesRequestObject

	request.Params = params

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.ListPolicies(ctx, request.(ListPoliciesRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "ListPolicies")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(ListPoliciesResponseObject); ok {
		if err := validResponse.VisitListPoliciesResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// CreatePolicy operation middleware
func (sh *strictHandler) CreatePolicy(ctx *gin.Context) {
	var request CreatePolicyRequestObject

	var body CreatePolicyJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.CreatePolicy(ctx, request.(CreatePolicyRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "CreatePolicy")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(CreatePolicyResponseObject); ok {
		if err := validResponse.VisitCreatePolicyResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// GetPolicy operation middleware
func (sh *strictHandler) GetPolicy(ctx *gin.Context, slug string) {
	var request GetPolicyRequestObject

	request.Slug = slug

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.GetPolicy(ctx, request.(GetPolicyRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "GetPolicy")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(GetPolicyResponseObject); ok {
		if err := validResponse.VisitGetPolicyResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// AddPolicyVersion operation middleware
func (sh *strictHandler) AddPolicyVersion(ctx *gin.Context, slug string) {
	var request AddPolicyVersionRequestObject

	request.Slug = slug

	var body AddPolicyVersionJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.AddPolicyVersion(ctx, request.(AddPolicyVersionRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "AddPolicyVersion")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(AddPolicyVersionResponseObject); ok {
		if err := validResponse.VisitAddPolicyVersionResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// GetPublicLinkInfo operation middleware
func (sh *strictHandler) GetPublicLinkInfo(ctx *gin.Context, token string) {
	var request GetPublicLinkInfoRequestObject

	request.Token = token

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.GetPublicLinkInfo(ctx, request.(GetPublicLinkInfoRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "GetPublicLinkInfo")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(GetPublicLinkInfoResponseObject); ok {
		if err := validResponse.VisitGetPublicLinkInfoResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// AcceptConsent operation middleware
func (sh *strictHandler) AcceptConsent(ctx *gin.Context, token string) {
	var request AcceptConsentRequestObject

	request.Token = token

	var body AcceptConsentJSONRequestBody
	if err := ctx.ShouldBindJSON(&body); err != nil {
		ctx.Status(http.StatusBadRequest)
		ctx.Error(err)
		return
	}
	request.Body = &body

	handler := func(ctx *gin.Context, request interface{}) (interface{}, error) {
		return sh.ssi.AcceptConsent(ctx, request.(AcceptConsentRequestObject))
	}
	for _, middleware := range sh.middlewares {
		handler = middleware(handler, "AcceptConsent")
	}

	response, err := handler(ctx, request)

	if err != nil {
		ctx.Error(err)
		ctx.Status(http.StatusInternalServerError)
	} else if validResponse, ok := response.(AcceptConsentResponseObject); ok {
		if err := validResponse.VisitAcceptConsentResponse(ctx.Writer); err != nil {
			ctx.Error(err)
		}
	} else if response != nil {
		ctx.Error(fmt.Errorf("unexpected response type: %T", response))
	}
}

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"0sWMqMY+ngXr2/X/AwAA///hG01ptzkAAA==",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
